@model Aula
@{
    ViewData["Title"] = "Aula";
}

@section Styles{
    <link href="~/css/SwitchButton.css" rel="stylesheet" />
    <link href="~/css/Estrelas.css" rel="stylesheet" />
}

<h2>Aula</h2>
<br />
<div class="list-group">
    <div class="list-group-item">
        <form role="form" asp-action="Form" method="post">
            <input asp-for="Id" type="hidden" />
            <input asp-for="ProfessorId" type="hidden" />
            <input asp-for="SalaId" type="hidden" />
            <input asp-for="CursoId" type="hidden" />
            <input asp-for="DataLimite" type="hidden" />
            <input asp-for="AulaDada" checked="checked" value="true" type="hidden" />

            <div class="row">
                <div class="col-md-2">
                    <div class="form-group">
                        <label asp-for="Data"></label>
                        <input asp-for="Data" hidden />
                        <input value="@Model.Data.ToString("dd/MM/yyyy HH:mm'h'")" disabled class="form-control" />
                        <span asp-validation-for="Data"></span>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <label asp-for="Professor"></label>
                        <input asp-for="Professor.Nome" class="form-control" disabled />
                        <span asp-validation-for="Data" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label asp-for="Curso"></label>
                        <input asp-for="Curso.Nome" class="form-control" disabled />
                        <span asp-validation-for="Curso" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label asp-for="Sala"></label>
                        <input asp-for="Sala.Nome" class="form-control" disabled />
                        <span asp-validation-for="Sala" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="form-group">
                        <label asp-for="DescAtividades"></label>
                        <textarea asp-for="DescAtividades" rows="10" cols="80">
                    </textarea>
                        <span asp-validation-for="DescAtividades" class="text-danger"></span>
                    </div>
                </div>
            </div>
            <hr />

            @for (int i = 0; i < Model.Chamadas.Count; i++)
            {
                <div class="list-group">
                    <div class="list-group-item">
                        <div class="row">

                            <div class="col-md-1">
                                <label>Histórico</label>
                                <div class="dropdown">
                                    <button class="btn btn-primary" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <div class="dropdown-menu" style="width: 320px; height: 500px; overflow-y: scroll;" aria-labelledby="dropdownMenuButton">
                                        @{
                                            var chamada = Model.Chamadas[i].PacoteCompra.Chamadas
                                            .OrderByDescending(c => c.Aula.Data)
                                            .FirstOrDefault(c => c.Presenca == true);
                                            if (chamada != null)
                                            {
                                                <div class="container">
                                                    @Html.Raw(chamada.Aula.DescAtividades)

                                                    @if (chamada.Observacao != null)
                                                    {
                                                        <hr />
                                                        <div>@chamada.Observacao</div>
                                                    }
                                                </div>

                                            }
                                        }
                                    </div>
                                </div>
                            </div>

                            @if (Model.Chamadas[i].Reposicao != null)
                            {
                                <div class="col-md-1">
                                    <label>Atenção</label>
                                    <button class="btn btn-outline-warning" id="reposicao" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <i class="fas fa-exclamation-circle"></i>
                                    </button>
                                    <div class="dropdown-menu" style="width: 320px; height: 500px; overflow-y: scroll;" aria-labelledby="dropdownMenuButton">
                                        <div class="container">
                                            <h4>Reposição</h4>
                                            <hr />
                                            <div>@Html.Raw(Model.Chamadas[i].Reposicao.Motivo)</div>
                                        </div>
                                    </div>
                                </div>
                            }

                            <input id="qtdAluno" value="@Model.Chamadas.Count" type="hidden" />
                            <input asp-for="Chamadas[i].Id" type="hidden" />
                            <input asp-for="Chamadas[i].AulaId" type="hidden" />
                            <input asp-for="Chamadas[i].PacoteCompraId" type="hidden" />
                            <input asp-for="Chamadas[i].Presenca" type="hidden">
                            <input asp-for="Chamadas[i].PacoteCompra.MatriculaId" type="hidden" />
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label asp-for="Chamadas[i].PacoteCompra.Matricula.Aluno"></label>
                                    <input value="@Model.Chamadas[i].PacoteCompra.Matricula.Aluno.Nome" class="form-control" disabled />
                                </div>
                            </div>
                            <div class="col-md-1">
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label id="labelSwitch@(i)">Presente</label><br />
                                        <label class="switch">
                                            <input id="switch@(i)" onclick="presenca(@i)" type="checkbox">
                                            <span class="slider round"></span>
                                        </label>
                                        <span asp-validation-for="Chamadas[i].Presenca" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-1">
                                <div class="form-group">
                                    <label asp-for="Chamadas[i].PacoteCompra.Matricula.Modulo"></label>
                                    <select asp-for="Chamadas[i].PacoteCompra.Matricula.Modulo" class="form-control">
                                        @for (var j = 1; j <= Model.Curso.QtdModulo; j++)
                                        {
                                            <option value="@j">@j</option>
                                        }
                                    </select>
                                </div>
                            </div>
                            <div class="@(Model.Chamadas[i].Reposicao == null ? "col-md-3" : "col-md-2")">
                                <div class="starrating risingstar d-flex justify-content-center flex-row-reverse" style="padding-top: 30px;">
                                    <input asp-for="Chamadas[i].PacoteCompra.Matricula.Estrelas" type="radio" id="star5@(Model.Chamadas[i].Id)" value="5" /><label for="star5@(Model.Chamadas[i].Id)" title="5 star"></label>
                                    <input asp-for="Chamadas[i].PacoteCompra.Matricula.Estrelas" type="radio" id="star4@(Model.Chamadas[i].Id)" value="4" /><label for="star4@(Model.Chamadas[i].Id)" title="4 star"></label>
                                    <input asp-for="Chamadas[i].PacoteCompra.Matricula.Estrelas" type="radio" id="star3@(Model.Chamadas[i].Id)" value="3" /><label for="star3@(Model.Chamadas[i].Id)" title="3 star"></label>
                                    <input asp-for="Chamadas[i].PacoteCompra.Matricula.Estrelas" type="radio" id="star2@(Model.Chamadas[i].Id)" value="2" /><label for="star2@(Model.Chamadas[i].Id)" title="2 star"></label>
                                    <input asp-for="Chamadas[i].PacoteCompra.Matricula.Estrelas" type="radio" id="star1@(Model.Chamadas[i].Id)" value="1" /><label for="star1@(Model.Chamadas[i].Id)" title="1 star"></label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label asp-for="Chamadas[i].Observacao"></label>
                                    <input asp-for="Chamadas[i].Observacao" class="form-control" />
                                    <span asp-validation-for="Chamadas[i].Observacao" class="text-danger"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
            <br />
            @for (var i = 0; i < Model.Demostrativas.Count; i++)
            {
                <div class="list-group">
                    <div class="list-group-item">
                        <div class="row">



                            <input id="DqtdAluno" value="@Model.Demostrativas.Count" type="hidden" />
                            <input asp-for="Demostrativas[i].Id" type="hidden" />
                            <input asp-for="Demostrativas[i].PessoaId" type="hidden" />
                            <input asp-for="Demostrativas[i].Presenca" type="hidden" />
                            <input asp-for="Demostrativas[i].Estrelas" type="hidden" />
                            <input asp-for="Demostrativas[i].CandidatoId" type="hidden" />
                            <input asp-for="Demostrativas[i].DispSalaId" type="hidden" />
                            <input asp-for="Demostrativas[i].CursoId" type="hidden" />
                            <input asp-for="Demostrativas[i].AulaId" type="hidden" />
                            <input asp-for="Demostrativas[i].Motivo" type="hidden" />
                            <input asp-for="Demostrativas[i].Contratou" type="hidden" />
                            <input asp-for="Demostrativas[i].Outros" type="hidden" />
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label asp-for="Demostrativas[i].Candidato"></label>
                                    <input value="@Model.Demostrativas[i].Candidato.Nome" class="form-control" disabled />
                                </div>
                            </div>
                            <div class="col-md-1">
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label id="DlabelSwitch@(i)">Presente</label><br />
                                        <label class="switch">
                                            <input id="Dswitch@(i)" onclick="Dpresenca(@i)" type="checkbox">
                                            <span class="slider round"></span>
                                        </label>
                                        <span asp-validation-for="Demostrativas[i].Presenca" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-3">
                                <div class="starrating risingstar d-flex justify-content-center flex-row-reverse" style="padding-top: 30px;">
                                    <input name="Estrelas[@i]" @(Model.Demostrativas[i].Estrelas == 5 ? "checked" : "") type="radio" id="Dstar5@(Model.Demostrativas[i].Id)" value="5" /><label for="Dstar5@(Model.Demostrativas[i].Id)" title="5 star"></label>
                                    <input name="Estrelas[@i]" @(Model.Demostrativas[i].Estrelas == 4 ? "checked" : "") type="radio" id="Dstar4@(Model.Demostrativas[i].Id)" value="4" /><label for="Dstar4@(Model.Demostrativas[i].Id)" title="4 star"></label>
                                    <input name="Estrelas[@i]" @(Model.Demostrativas[i].Estrelas == 3 ? "checked" : "") type="radio" id="Dstar3@(Model.Demostrativas[i].Id)" value="3" /><label for="Dstar3@(Model.Demostrativas[i].Id)" title="3 star"></label>
                                    <input name="Estrelas[@i]" @(Model.Demostrativas[i].Estrelas == 2 ? "checked" : "") type="radio" id="Dstar2@(Model.Demostrativas[i].Id)" value="2" /><label for="Dstar2@(Model.Demostrativas[i].Id)" title="2 star"></label>
                                    <input name="Estrelas[@i]" @(Model.Demostrativas[i].Estrelas == 1 ? "checked" : "") type="radio" id="Dstar1@(Model.Demostrativas[i].Id)" value="1" /><label for="Dstar1@(Model.Demostrativas[i].Id)" title="1 star"></label>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label asp-for="Demostrativas[i].Observacao"></label>
                                    <textarea asp-for="Demostrativas[i].Observacao" rows="5" cols="10">
                                    </textarea>
                                    <span asp-validation-for="Demostrativas[i].Observacao" class="text-danger"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
            <br />
            <button type="submit" class="btn btn-success col-md-4">Lançar</button>
        </form>
    </div>
</div>
<br />
@section Scripts{
    <script src="~/js/mask.js"></script>
    <script src="~/ckeditor/ckeditor.js"></script>
    <script>
        // Replace the <textarea id="editor1"> with a CKEditor
        // instance, using default configuration.
        CKEDITOR.replace('DescAtividades');
        @for(var i = 0; i < Model.Demostrativas.Count; i++)
        {
            <text>CKEDITOR.replace('Demostrativas_@(i)__Observacao');</Text>
        }
    </script>
    <script src="~/js/Aula.js"></script>
}