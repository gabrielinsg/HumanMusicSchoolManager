@model Aluno
@{
    ViewData["Title"] = "Financeiro";
}

<div class="row">
    <div class="col-10"><h2>@Model.Nome</h2></div>
    <div class="col-2"><a asp-controller="Aluno" asp-action="Aluno" asp-route-alunoId="@Model.Id" class="btn btn-success">Voltar</a> </div>
</div>
<br />
<ul class="list-group">
    <li class="list-group-item active">Histórico Financeiro</li>
    <li class="list-group-item">
        <table class="table table-sm table-hover small">
            <thead>
                <tr class="small">
                    <th scope="col">Nome</th>
                    <th scope="col">Valor</th>
                    <th scope="col">Desconto</th>
                    <th scope="col">Multa</th>
                    <th scope="col">Total</th>
                    <th scope="col">Valor Pago</th>
                    <th scope="col">Forma de Pagamento</th>
                    <th scope="col">Data de Criação</th>
                    <th scope="col">Data de Vencimento</th>
                    <th scope="col">Responsável</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var financeiro in Model.Financeiros)
                {
                    if (financeiro.Valor == null) { financeiro.Valor = 0; }
                    if (financeiro.Desconto == null) { financeiro.Desconto = 0; }
                    if (financeiro.Multa == null) { financeiro.Multa = 0;  }
                    var total = financeiro.Valor - financeiro.Desconto + financeiro.Multa;
                    <tr class="@(financeiro.ValorPago >= total ? "text-success" : "") @(financeiro.DataVencimento < DateTime.Now.AddDays(-1) && (financeiro.ValorPago < total || financeiro.ValorPago == null) ? "text-danger" : "")">
                        <td>@financeiro.Nome</td>
                        <td>@financeiro.Valor</td>
                        <td>@if (financeiro.Desconto != 0) { @financeiro.Desconto }</td>
                        <td>@if (financeiro.Multa != 0) { @financeiro.Multa }</td>
                        <td>@total</td>
                        <td>@financeiro.ValorPago</td>
                        <td>@Html.DisplayFor(d => financeiro.FormaPagamento)</td>
                        <td>@financeiro.DataGerada.ToString("dd/MM/yyyy")</td>
                        <td>@financeiro.DataVencimento.ToString("dd/MM/yyyy")</td>
                        <td>@financeiro.Pessoa.Nome</td>
                    </tr>
                }
            </tbody>
        </table>
    </li>
</ul>

